function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}
/**
 * For collecting WebAuthn authenticator details on factor setup
 *
 * @module     factor_webauthn/register
 * @copyright  Catalyst IT
 * @author     Alex Morris <alex.morris@catalyst.net.nz>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("factor_webauthn/register",["factor_webauthn/utils"],(function(utils){return{init:function(initialCreateArgs){var fn,_ref;document.getElementById("id_submitbutton").disabled=!0,document.getElementById("factor_webauthn-register").addEventListener("click",(fn=regeneratorRuntime.mark((function _callee(e){var createArgs,cred,authenticatorResponse,inputResponse;return regeneratorRuntime.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(navigator.credentials&&navigator.credentials.create){_context.next=2;break}throw new Error("Browser not supported.");case 2:if(e.preventDefault(),!1!==(createArgs=JSON.parse(initialCreateArgs)).success){_context.next=6;break}throw new Error(createArgs.msg||"unknown error occured");case 6:return utils.recursiveBase64StrToArrayBuffer(createArgs),_context.next=9,navigator.credentials.create(createArgs);case 9:cred=_context.sent,authenticatorResponse={transports:cred.response.getTransports?cred.response.getTransports():null,clientDataJSON:cred.response.clientDataJSON?utils.arrayBufferToBase64(cred.response.clientDataJSON):null,attestationObject:cred.response.attestationObject?utils.arrayBufferToBase64(cred.response.attestationObject):null},(inputResponse=document.getElementById("id_response_input")).value=JSON.stringify(authenticatorResponse),document.getElementById("id_submitbutton").disabled=!1,inputResponse.form.elements.submitbutton.click();case 15:case"end":return _context.stop()}}),_callee)})),_ref=function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))},function(_x){return _ref.apply(this,arguments)}))}}}));

//# sourceMappingURL=register.min.js.map